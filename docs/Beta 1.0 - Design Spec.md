# Beta 1.0 - Design Spec

标签（空格分隔）： Sudoku

---

## **文档日志**

| 日期       | 备注       |
| ---------- | ---------- |
| 2017-09-07 | 设计文档初稿审查
| 2017-09-07 | 设计文档初稿


---

## **1. 具体输入 / 输出 / 边界**

- **Sample Input（命令行输入）**
```
sudoku.exe -c 20
```

- **Sample Output（输出到sudoku.txt）**
```
2 6 8 4 7 3 9 5 1
3 4 1 9 6 5 2 7 8
7 9 5 8 1 2 3 6 4
5 7 4 6 2 1 8 3 9
1 3 9 5 4 8 6 2 7
8 2 6 3 9 7 4 1 5
9 1 7 2 8 6 5 4 3
6 8 3 1 5 4 7 9 2
4 5 2 7 3 9 1 8 6
```

- **边界**

| Param | Type | Range |
| ----- | ---- | ----- |
| 生成个数 **`N`** | 数字 | **`[1, 1000000]`**


---

## **2. 具体语言 / 工具**

- **System**：**`Windows 10`**
- **Language**：**`C++`**
- **IDE**：**`Visual Studio 2017 Community`**

--- 

## **3. 具体终盘生成算法设计（拟定为 方案一）**

### Update [2017-09-08]

- **【方案一】** 原方案实现采用棋盘转字符串后 **`set<string>`** 判重。
- **【方案一】** 分析发现 + 测试生成 50w 组数据发现，对于一个合法的终盘，仅采用 **“交换行 / 列”**、 **“交换数字”** 并不会引入重复的棋盘。
- **【方案一】** 原 set 判重逻辑块挪入测试类，考虑到只是原理上保证不重复，单元测试测不了那么多情况，所以提供【判重】指令作为生成后的后续选项。

### History [2017-09-07]

### **方案一：矩阵转换法**

- **详细资料：[《数独终盘生成的几种方法》][1]**
- **核心思想**：从一个初始终盘（**“种子”**），通过 **“交换行 / 列”**、 **“交换数字”** 等方法生成其余矩阵
- **具体方案**：**“交换行列”**、**“交换数字”**、**“旋转终盘”**、**“对角线对称”** 等。
- **优点 `速度较快`**：需要生成大量终盘的时候相当的高效。
- **缺点 `质量较差`**：同一 **“种子”** 生成的矩阵 **本质相同**，**“随机性”** 较差。
- **时间复杂度分析**：
 1. 假定已有种子，假定访问一遍棋盘的时间为 **`O(n)`**, 该算法的复杂度为 **`O(n)`** 级别。

### **方案二：随机法**

- **详细资料：**
 - **[《数独终盘生成的几种方法》][1]**
 - **[《基于“挖洞”思想的数独游戏生成算法》][2]**
- **核心思想**：一个个格子随机，终盘数量多达 **6.67×10^21**，能随机出来的概率很大。
- **优点 `质量较好`**：随机性较强。
- **缺点 `速度较慢`**：
- **具体方案**：
 - 对于当前搜索格子，把能放的数字拉出来。
 - 在这些数字中随机一个，然后搜下一个格子。
 - 为了保证质量，找到终盘后不采取回溯，直接重头搜索。

### **方案三：方案一 + 方案二 的 折衷**

- **考虑背景**：
 - 由于是使用时现场生成，所以考虑到运行时间很大程度取决于用户的计算机计算性能而非开发者（开发者的计算机性能普遍较好）
 - 方案一的交换法虽然快但是生成的都是 **等价终盘**，且会有很多终盘光看起来就惊人的相似，并且所有终盘（仅考虑交换行、列、数字）都能通过简单代码重编码成同一个终盘。
 - 如果计算机性能较好的情况下，我们倾向于让方案二的占比大一点，牺牲时间换质量。
 - 如果计算机性能较差的情况下，我们倾向于让方案一的占比大一点，牺牲质量换时间。
- **具体方案** 
 - 用 **方案二生成部分种子**，其余的由 **方案一通过这些种子生成** 
 - 提供输入质量百分比 **p (range[0, 100])**，默认为 **50** ；
 - **p 为 0**时： **性能最高** 模式，除了一个种子外完全采用方案一。
 - **p 为 100**时：**质量最高** 模式，尽可能多的采用方案二。
 - 运行时间 和 p 成正比。

---

## **4. 模块一 · Sudoku类**
- 实现 **`Sudoku`** 对象的行为；
- 包括：检测是否为合法终盘，交换行，交换列

## **5. 模块二 · SudokuGenerator类**
- 实现批量生成为合法终盘的 Sudoku 对象



[1]: https://my.oschina.net/wangmengjun/blog/781984
[2]: https://wenku.baidu.com/view/f9e3f17101f69e31433294e1.html